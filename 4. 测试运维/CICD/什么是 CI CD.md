CI/CD 的出现改变了开发人员和测试人员发布软件的方式。本文是描述这一变化的系列文章第一篇， 这些文章将提供各种工具和流程的讲解，以帮助开发人员更好的使用 CI/CD。



![img](https:////upload-images.jianshu.io/upload_images/17245322-8fae33f2543d2d1e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/853/format/webp)



从最初的 [瀑布模型](https://links.jianshu.com/go?to=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FWaterfall_model)， 到后来的 [敏捷开发](https://links.jianshu.com/go?to=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FAgile_software_development)， 再到今天的 [DevOps](https://links.jianshu.com/go?to=https%3A%2F%2Faws.amazon.com%2Fdevops%2Fwhat-is-devops%2F)， 这是现代开发人员构建出色产品的技术路线。 随着 DevOps 的兴起，出现了持续集成，持续交付（CI/CD）和持续部署的新方法， 而传统的软件开发和交付方式在迅速变得过时。过去的敏捷时代里， 大多数公司的软件发布周期是每月、每季度甚至每年（还记得那些日子吗？）， 而在现在 DevOps 时代，每周、每天甚至每天多次都是常态。 当 SaaS 成为业界主流后尤其如此，您可以轻松地动态更新应用程序， 而无需强迫用户下载更新组件。很多时候，用户甚至都不会注意到正在发生变化。

开发团队通过软件交付流水线（Pipeline）实现自动化，以缩短交付周期， 大多数团队都有自动化流程来检查代码并部署到新环境。 我们一直在关注自动化测试流程，但这将在之后的文章中介绍。 今天，我们将介绍什么是 CI/CD/CD ，以及现代软件公司如何使用工具将部署代码的流程自动化。

**持续集成**注重将各个开发者的工作集合到一个代码仓库中，通常每天会进行几次， 主要目的是尽早发现集成错误，使团队更加紧密结合，更好地协作。 **持续交付**的目的是最小化部署或发布过程中团队固有的摩擦， 它的实现通常能够将构建部署的每个步骤自动化，以便任何时刻能够安全地完成代码发布（理想情况下）。 **持续部署**是一种更高程度的自动化，无论何时代码有较大改动， 都会自动进行构建／部署。

以上的每一个阶段都是**交付流水线**的一部分。 [Humble 和 Ferley](https://links.jianshu.com/go?to=http%3A%2F%2Fwww.informit.com%2Farticles%2Farticle.aspx%3Fp%3D1621865%26seqNum%3D2) 在他们的书作《持续交付：通过自动化构建、测试和部署实现可靠软件版本发布》中解释说： "对软件的每次更改都要经过一个复杂的过程才能发布，该过程包括多个测试和部署阶段进行软件的构建。 反过来看，这个过程需要许多人之间的合作，甚至可能需要几个团队间合作。 部署流水线对这一过程进行建模，并且它的持续集成和发布管理工具能让您在代码从版本控制转移到各种测试和部署时， 查看和控制每次更改的过程。"



![img](https:////upload-images.jianshu.io/upload_images/17245322-68de9a62930b7103.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/787/format/webp)



持续集成（CI）

通过持续集成，开发人员能够频繁地将其代码集成到公共代码仓库的主分支中。 开发人员能够在任何时候多次向仓库提交作品，而不是独立地开发每个功能模块并在开发周期结束时一一提交。

这里的一个重要思想就是让开发人员更快更、频繁地做到这一点，从而降低集成的开销。 实际情况中，开发人员在集成时经常会发现新代码和已有代码存在冲突。 如果集成较早并更加频繁，那么冲突将更容易解决且执行成本更低。

当然，这里也有一些权衡，这个流程不提供额外的质量保障。 事实上，许多组织发现这样的集成方式开销更大，因为它们依赖人工确保新代码不会引起新的 bug 或者破坏现有代码。 为了减少集成期间的摩擦，持续集成依赖于测试套件和自动化测试。 然而，要认识到自动化测试和持续测试是完全不同的这一点很重要，我们会在文章结尾处详细说明。

CI 的目标是将集成简化成一个简单、易于重复的日常开发任务， 这样有助于降低总体的构建成本并在开发周期的早期发现缺陷。 要想有效地使用 CI 必须转变开发团队的习惯，要鼓励频繁迭代构建， 并且在发现 bug 的早期积极解决。

持续交付（CD）实际上是 CI 的扩展，其中软件交付流程进一步自动化，以便随时轻松地部署到生成环境中。 成熟的持续交付方案也展示了一个始终可部署的代码库。使用 CD 后，软件发布将成为一个没有任何紧张感的例行事件。 开发团队可以在日常开发的任何时间进行产品级的发布，而不需要详细的发布方案或者特殊的后期测试。

CD 集中依赖于部署流水线，团队通过流水线自动化测试和部署过程。此流水线是一个自动化系统， 可以针对构建执行一组渐进的测试套件。CD 具有高度的自动化，并且在一些云计算环境中也易于配置。

在流水线的每个阶段，如果构建无法通过关键测试会向团队发出警报。否则，将继续进入下一个测试， 并在连续通过测试后自动进入下一个阶段。流水线的最后一个部分会将构建部署到和生产环境等效的环境中。 这是一个整体的过程，因为构建、部署和环境都是一起执行和测试的，它能让构建在实际的生产环境可部署和可验证。

AWS 上提供了可靠的当前 CI/CD 的展示，亚马逊是云计算的提供商之一，提供出色的 CI/CD 流水线环境和实验过程， 有众多开发资源可供选择，您可以将它们在一个易于配置和监控的流水线中组合起来。



![img](https:////upload-images.jianshu.io/upload_images/17245322-f5e590cf48e7fca0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/837/format/webp)



许多人认为持续交付的吸引力主要在于，它自动化了从提交代码到仓库，再到测试和发布产品过程的所有步骤。 这是构建和测试过程细致的自动化，但是如何发布以及发布什么仍然是需要人工操作，持续部署可以改变这一点。

持续部署（CD）

持续部署扩展了持续交付，以便软件构建在通过所有测试时自动部署。在这样的流程中， 不需要人为决定何时及如何投入生产环境。CI/CD 系统的最后一步将在构建后的组件/包退出流水线时自动部署。 此类自动部署可以配置为快速向客户分发组件、功能模块或修复补丁，并准确说明当前提供的内容。

采用持续部署的组织可以将新功能快速传递给用户，得到用户对于新版本的快速反馈，并且可以迅速处理任何明显的缺陷。 用户对无用或者误解需求的功能的快速反馈有助于团队规划投入，避免将精力集中于不容易产生回报的地方。

随着 DevOps 的发展，新的用来实现 CI/CD 流水线的自动化工具也在不断涌现。这些工具通常能与各种开发工具配合， 包括像 GitHub 这样的代码仓库和 Jira 这样的 bug 跟踪工具。此外，随着 SaaS 这种交付方式变得更受欢迎， 许多工具都可以在现代开发人员运行应用程序的云环境中运行，例如 [GCP](https://links.jianshu.com/go?to=https%3A%2F%2Fcloud.google.com%2F) 和 AWS。

最受欢迎的自动化工具是 [Jenkins](https://links.jianshu.com/go?to=https%3A%2F%2Fjenkins.io%2F)（以前的 Hudson）， 这是一个由数百名贡献者和商业公司 [Cloudbees](https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cloudbees.com%2F) 支持的开源项目。 Cloudbees 甚至聘请了 Jenkins 的创始人，并提供了一些 Jenkins 培训项目和附加组件。 除了开源项目之外，还有一些更现代化的商业产品例如 CircleCI，Codeship 和 Shippable。 这些产品各有优缺点，我鼓励开发人员在开发流程中一一尝试它们，以了解它们在您的环境中的工作方式， 以及它们如何与您的工具、云平台、容器系统等协作。

在 mabl 中，我们在 [Google Cloud Platform 上进行构建](https://links.jianshu.com/go?to=https%3A%2F%2Fwww.mabl.com%2Fblog%2Fvalidating-100-million-pages-kubernetes)， 因此，我们正在寻找与 GSP 兼容或者最好是已经集成进 GSO 的产品。我们尝试过 CircleCI，Codeship 和 Shippable， 下面有一个简单的表格，展示了每个工具的一些细节：





![img](https:////upload-images.jianshu.io/upload_images/17245322-d074a519d6352d70.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/756/format/webp)





![img](https:////upload-images.jianshu.io/upload_images/17245322-e5a5b8f0779653aa.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/754/format/webp)



我们最终选择了 [Codeship](https://links.jianshu.com/go?to=http%3A%2F%2Fcodeship.com%2F)，我认为我们的选择是正确的， 也感谢 Codeship 团队的支持。

接下来？

一旦部署了现代化的 CI/CD 流水线，您可能会意识到开发人员工作流程中的一些工具和流程也需要进行现代化改造。 测试是一个要着重关注的领域，如果您的部署频率是每天或者一天多次，您的每次测试可能需要数小时甚至一晚上才能完成。 mabl 正在使用机器学习解决这个问题。

作者：yJunS

链接：https://www.jianshu.com/p/5643b1cf9e3f

来源：简书

简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。



# 一文秒懂CI, CD AND CD

2018年12月20日 11:24:57 [程序员杂谈](https://me.csdn.net/q947448283) 阅读数：441



# 转自：<https://www.sohu.com/a/204652724_640923>

**CI, CD AND CD**

CI很容易理解，就是持续集成。但是CD既可以指代码持续交付，也可理解为代码持续部署。CI和CD之间有很多相似的部分，但是也有很大的区别。

**持续集成（CONTINUOUS INTEGRATION）**

在持续集成环境中，开发人员将会频繁的提交代码到主干。这些新提交在最终合并到主线之前，都需要通过编译和自动化测试流进行验证。这样做是基于之前持续集成过程中很重视自动化测试验证结果，以保障所有的提交在合并主线之后的质量问题，对可能出现的一些问题进行预警。

**持续交付（CONTINUOUS DELIVERY）**

持续交付就是讲我们的应用发布出去的过程。这个过程可以确保我们尽可能快的实现交付。这就意味着除了自动化测试，我们还需要有自动化的发布流，以及通过一个按键就可以随时随地实现应用的部署上线。

通过持续交付，您可以决定每天，每周，每两周发布一次，这完全可以根据自己的业务进行设置。

但是，如果您真的希望体验持续交付的优势，就需要先进行小批量发布，尽快部署到生产线，以便在出现问题时方便进行故障排除。

**持续部署（CONTINUOUS DEPLOYMENT）**

如果我们想更加深入一步的话，就是持续部署了。通过这个方式，任何修改通过了所有已有的工作流就会直接和客户见面。没有人为干预（没有一键部署按钮），只有当一个修改在工作流中构建失败才能阻止它部署到产品线。

持续部署是一个很优秀的方式，可以加速与客户的反馈循环，但是会给团队带来压力，因为不再有“发布日”了。开发人员可以专注于构建软件，他们看到他们的修改在他们完成工作后几分钟就上线了。基本上，当开发人员在主分支中合并一个提交时，这个分支将被构建、测试，如果一切顺利，则部署到生产环境中。

**合并CI CD and CD？**

当然，正如我所说，他们每部分都更加接近生产环境。你可以构建自己的持续集成环境，然后，一旦团队适应，你可以添加持续交付流，最后，可以添加持续部署流到整个工作流中。

![img](https://img-blog.csdnimg.cn/20181220112457237)

举例CI, CD and CD 流水线

**到底值不值这样做呢?**

**持续集成:**

**你需要具备哪些条件:**

你的团队需要为每个新功能，代码改进，或者问题修复创建自动化测试用例。

你需要一个持续集成服务器，它可以监控代码提交情况，对每个新的提交进行自动化测试。

研发团队需要尽可能快的提交代码，至少每天一次提交。

**你能获得什么呢？**

通过自动化测试可以提早拿到回归测试的结果，避免将一些问题提交到交付生产中

发布编译将会更加容易，因为合并之初已经将所有问题都规避了

减少工作问题切换，研发可以很快获得构建失败的消息，在开始下一个任务之前就可以很快解决。

测试成本大幅降低-你的CI服务器可以在几秒钟之内运行上百条测试。

你的QA团队花费在测试上面的时间会大幅缩短，将会更加侧重于质量文化的提升上面。

**持续交付**

**需要具备什么条件？**

你需要有强大的持续集成组件和足够多的测试项可以满足你代码的需求

部署需要自动化。触发是手动的，但是部署一旦开始，就不能人为干预。

你的团队可能需要接受特性开关，没有完成的功能模块不会影响到线上产品。

**你能收获什么？**

繁琐的部署工作没有了。你的团队不在需要花费几天的时间去准备一个发布。

你可以更快的进行交付，这样就加快了与客户之间的反馈环。

轻松应对小变更，加速迭代

**持续部署**

**需要具备的条件:**

研发团队测试理念比较完善。测试单元的健壮性直接决定你的交付质量。

你的文档和部署频率要保持一致。

特征标志成为发布重大变化过程的固有部分，以确保您可以与其他部门（支持，市场营销，公关…）协调。

**可以获得什么？**

发布频率更快，因为你不需要停下来等待发布。每一处提交都会自动触发发布流。

在小批量发布的时候，风险降低了，发现问题也可以很轻松的修复。

客户每天都可以看到我们的持续改进和提升，而不是每个月或者每季度，或者每年。

如前所述，您可以采用持续集成，持续交付和持续部署。你怎么做取决于你的需求和你的业务情况。如果你刚刚开始一个项目，并且还没有客户，那么你就可以去创建这些工作流，最好是将这三个方面都实现，并且在你的项目迭代和需求增长中同时迭代它们。如果您已经有一个生产项目，那么您可以一步一步地分阶段去实现他们。



简述:

CI: 持续集成,包括开发提交代码至打包并保存至仓库的整个过程；

CD: 持续部署,部署到多台应用节点上的过程；

简图：



![img](https://upload-images.jianshu.io/upload_images/16250937-dcfc6422ce3e5b2d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/905/format/webp)

架构：Gitlab + jenkins +maven +artifactory + python+ ansible